<div class="layout-container">
    <ng-container *rxLet="view$;
    let view;
    error: error;
    suspense: suspense;">
        <div class="flex flex-col gap-6">

            <div class="flex flex-row items-center">
                <div class="mx-auto flex flex-row items-center gap-4">
                    <div *rxIf="view.circle.private"
                         class="flex flex-col items-center">
                        <mat-icon>
                            lock
                        </mat-icon>
                        <span class="text-gray-500 text-xs">Private</span>
                    </div>
                    <h2>
                        {{view.circle.name}}
                    </h2>
                </div>
                <a mat-button
                   color="primary"
                   [routerLink]="['/circles', view.circle.id, 'edit']"
                   [disabled]="view.disabled"
                   class="self-end">
                    Edit
                </a>
            </div>

            <div class="relative h-[14rem] w-full">
                <img class="object-cover"
                     ngSrc="{{view.circle.imageSrc}}"
                     alt="{{view.circle.name}}"
                     fill="true">
            </div>

            <div>
                <a routerLink="/circles"
                   mat-button
                   color="accent">
                    Go to Ranking List
                </a>
            </div>

            <section id="circleMetaData"
                     class="flex flex-row justify-between">
                <div>
                    <h3>
                        Owner
                    </h3>
                    <vyf-circle-member [member$]="view.owner$"
                                       [opts]="circleMemberComponentOption">
                    </vyf-circle-member>
                </div>

                <div class="flex flex-col">
                    <h3 class="text-xl font-normal text-gray-900 mb-2">
                        Valid until
                    </h3>
                    <p>{{view.circle.validUntil | date}}</p>
                    <p>{{view.circle.validUntil | date:'shortTime'}}</p>
                </div>
            </section>

            <div>
                <h3>
                    Description
                </h3>
                <p class="md:max-w-5xl">
                    {{view.circle.description}}
                </p>
            </div>

            <div>
                <h3>
                    Members
                </h3>
                <div *rxIf="view.members$.length; else: noMembers"
                     class="flex flex-row gap-4 items-center">
                    <ng-container *rxFor="let member$ of view.members$;">
                        <vyf-circle-member [member$]="member$"
                                           [opts]="circleMembersComponentOption">
                        </vyf-circle-member>
                    </ng-container>
                    <div class="w-14 h-14 rounded hover:text-gray-950 hover:font-semibold">
                        <a [routerLink]="['/circles', view.circle.id ,'members']"
                           class="w-full h-full flex flex-col justify-center items-center">
                            <div>
                                +{{view.votersCount}}
                            </div>
                            <div>
                                -- -- --
                            </div>
                        </a>
                    </div>
                </div>

                <ng-template #noMembers>
                    <div>
                        <a [routerLink]="['/circles', view.circle.id, 'members']"
                           mat-button
                           color="accent">
                            <mat-icon>
                                add
                            </mat-icon>
                            There are no Members - Add some
                        </a>
                    </div>
                </ng-template>
            </div>

        </div>
    </ng-container>

    <ng-template #suspense>
        <div class="flex justify-center items-center">
            <mat-spinner></mat-spinner>
        </div>
    </ng-template>
    <ng-template #error>ERROR!</ng-template>
</div>
